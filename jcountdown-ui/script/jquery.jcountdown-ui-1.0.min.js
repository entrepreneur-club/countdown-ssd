/* jCountdown UI 1.0 jQuery Widget | Copyright 2012 Tom Ellis http://www.webmuse.co.uk | MIT Licensed (license.txt) */
(function(f){var u=window.clearInterval,s=Math.floor,v=Math.ceil;f.widget("jui.countdownui",{options:{date:null,updateTime:1E3,minus:false,onChange:null,onComplete:null,onResume:null,onPause:null,leadingZero:false,offset:null,servertime:null,hoursOnly:false,minsOnly:false,secsOnly:false,hours:false,yearsAndMonths:false,direction:"down",yearsText:"years",monthsText:"months",daysText:"days",hoursText:"hours",minutesText:"minutes",secondsText:"seconds",speed:500,fx:"turnDown"},_create:function(){var a=
this.options,b=f(this.element),e={},d,m,t=f("<div>").addClass("jc-ui ui-widget ui-widget-content ui-corner-all"),p=f("<div>").addClass("jc-ui-days ui-corner-left"),q=f("<div>").addClass("jc-ui-hours"),r=f("<div>").addClass("jc-ui-minutes"),h=f("<div>").addClass("jc-ui-seconds ui-corner-right"),j=f("<p>").addClass("ui-widget-content ui-state-default jui-first jui-active"),i=f("<p>").addClass("ui-widget-content ui-state-default jui-last jui-not-active");if(a.date===null){f.error("No Date passed to jCountdown UI. date option is required.");
return false}(new Date(a.date)).toString()==="Invalid Date"&&f.error("Invalid Date passed to jCountdown UI: "+a.date);if(b.data("jcdUIData")){b.countdownui("changeSettings",this.options,true);a=b.data("jcdUIData")}if(a.yearsAndMonths){d=f("<div>").addClass("jc-ui-years ui-corner-left");m=f("<div>").addClass("jc-ui-months")}a.onChange&&b.on("change.jcduievt",a.onChange);a.onComplete&&b.on("complete.jcduievt",a.onComplete);a.onPause&&b.on("pause.jcduievt",a.onPause);a.onResume&&b.on("resume.jcduievt",
a.onResume);e={originalHTML:b.html(),date:a.date,hoursOnly:a.hoursOnly,minsOnly:a.minsOnly,secsOnly:a.secsOnly,yearsAndMonths:a.yearsAndMonths,leadingZero:a.leadingZero,offset:a.offset,servertime:a.servertime,updateTime:a.updateTime,direction:a.direction,minus:a.minus,onChange:a.onChange,onComplete:a.onComplete,onResume:a.onResume,onPause:a.onPause,timer:0,prevYears:undefined,prevMonths:undefined,prevDays:undefined,prevHrs:undefined,prevMins:undefined,prevSec:undefined,yearsText:a.yearsText,monthsText:a.monthsText,
daysText:a.daysText,hoursText:a.hoursText,minutesText:a.minutesText,secondsText:a.secondsText,speed:a.speed,fx:a.fx,hasCompleted:false};b.html("");if(e.hoursOnly){q.addClass("ui-corner-left");p.hide()}else{p.addClass("ui-corner-left");p.append(j.clone(),i.clone())}a.yearsAndMonths&&p.removeClass("ui-corner-left");q.append(j.clone(),i.clone());r.append(j.clone(),i.clone());h.append(j.clone(),i.clone());if(e.yearsAndMonths){d.append(j.clone(),i.clone());m.append(j.clone(),i.clone());t.append(d,m)}t.append(p,
q,r,h).appendTo(b);if(a.servertime!==null){d=new Date;a=f.isFunction(e.servertime)?e.servertime():e.servertime;e.difference=d.getTime()-a}a=f.proxy(this._timerFunc,this);e.timer=setInterval(a,e.updateTime);b.data("jcdUIData",e);a()},_timerFunc:function(){var a=f(this.element),b=a.find(".jc-ui-years"),e=a.find(".jc-ui-months"),d=a.find(".jc-ui-days"),m=a.find(".jc-ui-hours"),t=a.find(".jc-ui-minutes"),p=a.find(".jc-ui-seconds"),q,r,h,j,i,l,n,o,c=a.data("jcdUIData"),g,k;if(!c)return false;g={cb:f.noop(),
cssBefore:{},cssAfter:{},speedIn:c.speed,speedOut:c.speed,animIn:{},animOut:{},easeIn:null,easeOut:null,sync:true};q=c.offset===null&&c.servertime===null?new Date:c.offset!==null?this._getTZDate(c.offset):this._getTZDate(null,c.difference);r=new Date(c.date);h=c.direction==="down"?r.getTime()-q.getTime():q.getTime()-r.getTime();k=Math.round(h/1E3);o=k%60;k=s(k/60);n=k%60;k=s(k/60);l=k%24;h=k=s(k/24);if(c.yearsAndMonths){j=s(k/365);k=s(k%365);i=s(k/30);if(i===12){j=1;i=0;k=12}h=v(k%30)}if(c.hoursOnly){l+=
h*24;h=0}if(c.minsOnly){n+=l*60+h*24*60;l=h=0}if(c.secsOnly){o+=n*60;n=l=h=0}if(c.leadingZero){if(j<10)j="0"+j;if(i<10)i="0"+i;if(h<10&&!c.hoursOnly)h="0"+h;if(l<10)l="0"+l;if(n<10)n="0"+n;if(o<10)o="0"+o}if(!c.minus&&c.direction==="down"&&q>=r)c.hasCompleted=true;if(!c.hoursOnly)if(c.prevDays===undefined){c.prevDays=h;d.find("p.jui-active").html(h+" "+c.daysText)}if(c.yearsAndMonths){if(c.prevYears===undefined){c.prevYears=j;b.find("p.jui-active").html(j+" "+c.yearsText)}if(c.prevMonths===undefined){c.prevMonths=
i;e.find("p.jui-active").html(i+" "+c.monthsText)}}if(c.prevHrs===undefined){c.prevHrs=l;m.find("p.jui-active").html(l+" "+c.hoursText)}if(c.prevMins===undefined){c.prevMins=n;t.find("p.jui-active").html(n+" "+c.minutesText)}if(c.prevSec===undefined){c.prevSec=o;p.find("p.jui-active").html(o+" "+c.secondsText)}if(c.yearsAndMonths){if(c.prevYears!==j){g.timeLeft=j;g.timeText=c.yearsText;f.fn.countdownui.transitions[c.fx](b,g);f.fn.countdownui.animate(b,g)}if(c.prevMonths!==i){g.timeLeft=i;g.timeText=
c.monthsText;f.fn.countdownui.transitions[c.fx](e,g);f.fn.countdownui.animate(e,g)}}if(c.prevDays!==h&&!c.hoursOnly){g.timeLeft=h;g.timeText=c.daysText;f.fn.countdownui.transitions[c.fx](d,g);f.fn.countdownui.animate(d,g)}if(c.prevHrs!==l){g.timeLeft=l;g.timeText=c.hoursText;f.fn.countdownui.transitions[c.fx](m,g);f.fn.countdownui.animate(m,g)}if(c.prevMins!==n){g.timeLeft=n;g.timeText=c.minutesText;f.fn.countdownui.transitions[c.fx](t,g);f.fn.countdownui.animate(t,g)}if(c.prevSec!==o){g.timeLeft=
o;g.timeText=c.secondsText;f.fn.countdownui.transitions[c.fx](p,g);f.fn.countdownui.animate(p,g)}c.yearsLeft=j;c.monthsLeft=i;c.daysLeft=h;c.hrsLeft=l;c.minsLeft=n;c.secLeft=o;c.prevYears=j;c.prevMonths=i;c.prevDays=h;c.prevHrs=l;c.prevMins=n;c.prevSec=o;a.trigger("change.jcduievt",[c]);if(c.hasCompleted){a.trigger("complete.jcduievt");clearInterval(c.timer)}},_getTZDate:function(a,b){var e,d;d=new Date;if(a===null)d=d.getTime()-b;else{e=a*36E5;e=d.getTime()- -d.getTimezoneOffset()/60*36E5+e;d=d.setTime(e)}return new Date(d)},
complete:function(){var a=f(this.element),b=a.data("jcdUIData");if(!b)return false;clearInterval(b.timer);b.hasCompleted=true;a.data("jcdUIData",b).trigger("complete.jcduievt").off(".jcduievt");return true},destroy:function(){var a=f(this.element),b;b=a.data("jcdUIData");if(!b)return false;f.Widget.prototype.destroy.call(this);clearInterval(b.timer);a.off(".jcduievt").removeData("jcdUIData").html(b.originalHTML);return true},changeSettings:function(a,b){var e=f(this.element),d,m=f.proxy(this._timerFunc,
this);if(!e.data("jcdUIData"))return true;if(a.hasOwnProperty("date")){d=new Date(a.date);d.toString()==="Invalid Date"&&f.error("Invalid Date passed to jCountdown UI: "+a.date)}d=f.extend({},e.data("jcdUIData"),a);d.completed=false;u(d.timer);e.off(".jcduievt").data("jcdUIData",d);if(!b){d.onChange&&e.on("change.jcduievt",d.onChange);d.onComplete&&e.on("complete.jcduievt",d.onComplete);d.onPause&&e.on("pause.jcduievt",d.onPause);d.onResume&&e.on("resume.jcduievt",d.onResume);d.timer=setInterval(m,
d.updateTime);e.data("jcdUIData",d);m()}},resume:function(){var a=f(this.element),b=a.data("jcdUIData"),e=f.proxy(this._timerFunc,a);if(!b)return a;a.data("jcdUIData",b).trigger("resume.jcduievt");if(!b.hasCompleted){b.timer=setInterval(e,b.updateTime);e()}},pause:function(){var a=f(this.element),b=a.data("jcdUIData");if(!b)return a;u(b.timer);a.data("jcdUIData",b).trigger("pause.jcduievt")},getSettings:function(a){var b=f(this.element).data("jcdUIData");if(a&&b){if(b.hasOwnProperty(a))return b[a]}else return b}});
f.fn.countdownui.transitions={turnDown:function(a,b){var e=a.find("p.jui-active"),d=a.find("p.jui-not-active");b.animOut="jswing";b.animIn="jswing";b.animIn={top:"0"};b.animOut={top:"25px"};b.cb=function(){e.removeClass("jui-active").addClass("jui-not-active").css("top","-25px").hide();d.removeClass("jui-not-active").addClass("jui-active")}},turnUp:function(a,b){var e=a.find("p.jui-active"),d=a.find("p.jui-not-active");b.animOut="jswing";b.animIn="jswing";b.animIn={top:"0"};b.animOut={top:"-25px"};
d.css("top","25px");b.cb=function(){e.removeClass("jui-active").addClass("jui-not-active").css("top","25px").hide();d.removeClass("jui-not-active").addClass("jui-active")}},fade:function(a,b){var e=a.find("p.jui-active"),d=a.find("p.jui-not-active");b.animOut="jswing";b.animIn="jswing";d.css({zIndex:5,top:"0",opacity:1}).show();e.css({zIndex:6,top:"0"});b.animOut={opacity:0};b.cb=function(){e.removeClass("jui-active").addClass("jui-not-active").css("zIndex","5").hide();d.removeClass("jui-not-active").addClass("jui-active").css("zIndex",
"6")}},basic:function(a,b){var e=a.find("p.jui-active"),d=a.find("p.jui-not-active");b.animOut="jswing";b.animIn="jswing";d.css({zIndex:5,top:"0",opacity:1}).show();e.css({zIndex:6,top:"0",opacity:0});b.animOut={};b.cb=function(){e.removeClass("jui-active").addClass("jui-not-active").css("zIndex","5").hide();d.removeClass("jui-not-active").addClass("jui-active").css("zIndex","6")}}};f.fn.countdownui.animate=function(a,b){var e=a.find("p.jui-active"),d=a.find("p.jui-not-active"),m=function(){e.animate(b.animOut,
b.speedOut,b.easeOut,function(){b.cb()})};e.css(b.cssBefore);d.html(b.timeLeft+" "+b.timeText);d.show().animate(b.animIn,b.speedIn,b.easeIn,function(){d.css(b.cssAfter);b.sync||m()});b.sync&&m()}})(jQuery);